language: bash
sudo: enabled

matrix:
  include:
  - name: "CUDALucas"
    before_script:
    - sed -i '/^GPU=/,/^fi/ s/^/# /' cudalucas.sh
    - sed -i '/^if ! COMPUTE=/,/^fi/ s/^/# /' cudalucas.sh
    - sed -i 's/\/$COMPUTE/\/--generate-code arch=compute_35,code=sm_35/' cudalucas.sh
    - sed -i '/^\.\/CUDALucas / s/^/# /' cudalucas.sh
    - sed -i '/^nohup / s/^/# /' cudalucas.sh
    - sed -i '/^crontab / s/^/# /' cudalucas.sh
    script:
    - bash -e cudalucas.sh -- password ANONYMOUS
  - name: "Mlucas"
    before_script:
    - sed -i '/^[[:blank:]]*nohup / s/^/# /' mlucas.sh
    - sed -i '/^crontab / s/^/# /' mlucas.sh
    script:
    - bash -e mlucas.sh -- password ANONYMOUS

after_script:
    - bash -c 'shopt -s globstar; shellcheck -s bash **/*.sh || true'

